<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>íœ ë„ì‹œ â€“ Wheel City</title>

    <!-- Kakao SDK -->
    <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=01785b9a288ab46417b78a3790ac85c5&libraries=services&autoload=false"></script>

    <style>
      :root{
        /* === Light Theme === */
        --bg:#f6f8fb;        /* í˜ì´ì§€ ë°°ê²½ */
        --panel:#ffffff;      /* ì¹´ë“œ/íŒ¨ë„ ë°°ê²½ */
        --panel-2:#f1f5f9;    /* hover ë°°ê²½ */
        --border:#d0d7e2;     /* í…Œë‘ë¦¬ */
        --text:#0b1220;       /* ë³¸ë¬¸ ê¸€ììƒ‰ (ì§„í•œ ë‚¨ìƒ‰ ê³„ì—´) */
        --muted:#5b6b86;      /* ë³´ì¡° ê¸€ììƒ‰ */
        --accent:#0ea5e9;     /* í¬ì¸íŠ¸ (í•˜ëŠ˜ìƒ‰) */
        --frame:#ffffff;      /* ì§€ë„ ì˜ì—­ ë°°ê²½ */
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0;background:var(--bg);color:var(--text);
        font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Helvetica,Arial
      }

      /* ===== ìƒë‹¨/í•˜ë‹¨: ê¸°ì¡´ êµ¬ì¡° ìœ ì§€ (ë°ê²Œ) ===== */
      .app{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
      header.top{
        position:sticky;top:0;z-index:20;background:rgba(255,255,255,.9);
        backdrop-filter:blur(8px);border-bottom:1px solid var(--border);
      }
      .top-inner{
        max-width:1200px;margin:0 auto;padding:12px 16px;display:grid;gap:12px;
        grid-template-columns:1fr 520px auto;align-items:center;
      }
      .brand{display:flex;gap:10px;align-items:center;font-weight:800;letter-spacing:.3px}
      .brand .dot{
        width:10px;height:10px;border-radius:999px;background:var(--accent);
        box-shadow:0 0 10px rgba(14,165,233,.5)
      }
      .search{
        display:flex;gap:8px;align-items:center;background:var(--panel);
        border:1px solid var(--border);border-radius:14px;padding:8px 10px;
      }
      .search input{all:unset;flex:1;font-size:15px;color:var(--text)}
      .btn{
        cursor:pointer;border:1px solid var(--border);background:var(--panel);
        color:var(--text);height:40px;padding:0 14px;border-radius:10px;font-weight:700
      }
      .btn:hover{outline:1px solid #bfd3ea}
      .btn:active{transform:translateY(1px)}

      footer{
        border-top:1px solid var(--border);background:rgba(255,255,255,.9);
        color:var(--muted);
      }
      .footer-inner{
        max-width:1200px;margin:0 auto;padding:14px 16px;font-size:12px;
        display:flex;flex-wrap:wrap;gap:12px;justify-content:space-between;align-items:center;
      }
      .credit a{color:var(--muted);text-decoration:underline}

      /* ===== ë³¸ë¬¸(ì§€ë„ë¡œ ìµœëŒ€ ì±„ì›€) ===== */
      .main-wrap{
        width:100vw;
        display:grid;
        grid-template-columns:260px minmax(0,1fr); /* ì™¼ìª½ ë©”ë‰´ í­ ê³ ì • */
        gap:0;
      }

      /* ì™¼ìª½ ë©”ë‰´: í­/ìŠ¤íƒ€ì¼ ìœ ì§€, ì¢Œì¸¡ ê³ ì • */
      aside.nav{
        background:var(--panel);
        border-right:1px solid var(--border);
        padding:12px;
        min-height:100%;
      }
      .nav h3{margin:4px 8px 10px;font-size:13px;color:var(--muted);font-weight:700}
      .menu{display:grid;gap:6px}
      .menu a{
        display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;
        color:var(--text);text-decoration:none;background:transparent;border:1px solid transparent;
      }
      .menu a:hover{background:var(--panel-2);border-color:var(--border)}
      .menu .badge{font-size:11px;color:var(--muted)}

      /* ì§€ë„ ì˜ì—­ */
      .map-area{ position:relative; background:var(--frame); }
      #mapWrap{ position:relative; width:100%; }
      #map{
        position:absolute; inset:0;
        border-left:1px solid var(--border);
      }

      /* ì§€ë„ ìš°ìƒë‹¨ íˆ´ë°” */
      .map-toolbar{
        position:absolute; top:12px; right:12px; z-index:5;
        display:flex; gap:8px;
        background:rgba(255,255,255,.9); border:1px solid var(--border);
        padding:8px; border-radius:12px;
      }

      @media (max-width: 980px){
        .top-inner{grid-template-columns:1fr auto auto}
        .main-wrap{grid-template-columns:1fr}
        aside.nav{border-right:none;border-bottom:1px solid var(--border)}
        #map{border-left:none}
      }
    </style>
  </head>
  <body>
    <div class="app">
      <!-- ===== í—¤ë” ===== -->
      <header class="top">
        <div class="top-inner">
          <div class="brand">
            <span class="dot"></span>
            <span>íœ ë„ì‹œ</span>
          </div>
          <form id="searchForm" class="search" onsubmit="return false;">
            <input id="keyword" type="text" placeholder="ì¥ì†Œ/ì£¼ì†Œ ê²€ìƒ‰ (ì˜ˆ: ë¬´ì¥ì•  í™”ì¥ì‹¤, ê²½ì‚¬ë¡œ, ì¹´í˜)" />
            <button id="searchBtn" class="btn" type="button" title="ê²€ìƒ‰">ê²€ìƒ‰</button>
          </form>
          <!-- ë¡œê·¸ì¸ -->
          <button class="btn" id="loginBtn" type="button" onclick="location.href='login.html'">ë¡œê·¸ì¸</button>
        </div>
      </header>

      <!-- ===== ë³¸ë¬¸(ë©”ë‰´ + ì§€ë„ ìµœëŒ€) ===== -->
      <div class="main-wrap">
        <!-- ì™¼ìª½ ë©”ë‰´ -->
        <aside class="nav" aria-label="ì‚¬ì´ë“œ ë©”ë‰´">
          <h3>ë©”ë‰´</h3>
          <nav class="menu">
            <a href="about.html" title="íœ ë„ì‹œ ì†Œê°œ">ğŸ“– ì†Œê°œ <span class="badge">About</span></a>
            <a href="report.html" title="ê²½ì‚¬ë¡œ ì œë³´í•˜ê¸°">ğŸ§­ ê²½ì‚¬ë¡œ ì œë³´í•˜ê¸° <span class="badge">Report</span></a>
            <a href="map.html" title="ì ‘ê·¼ì„± ì§€ë„">ğŸ—ºï¸ ì ‘ê·¼ì„± ì§€ë„ <span class="badge">Map</span></a>
            <a href="help.html" title="ë„ì›€ë§/ë¬¸ì˜">ğŸ’¬ ë„ì›€ë§/ë¬¸ì˜ <span class="badge">Help</span></a>
          </nav>
        </aside>

        <!-- ì§€ë„ -->
        <section class="map-area" aria-label="ì§€ë„ ì˜ì—­">
          <div class="map-toolbar">
            <button class="btn" id="roadmap" title="ì¼ë°˜ ì§€ë„" style="height:32px">ì¼ë°˜</button>
            <button class="btn" id="skyview" title="ìŠ¤ì¹´ì´ë·°" style="height:32px">ìŠ¤ì¹´ì´ë·°</button>
            <button class="btn" id="fitBoundsBtn" title="ê²°ê³¼ ë²”ìœ„ë§ì¶¤" style="height:32px">ë²”ìœ„</button>
          </div>
          <div id="mapWrap">
            <div id="map" aria-label="Kakao Map"></div>
          </div>
        </section>
      </div>

      <!-- ===== í‘¸í„° ===== -->
      <footer>
        <div class="footer-inner">
          <div class="credit">Â© 2025 íœ ë„ì‹œ</div>
          <div class="credit">ì§€ë„/Map API ì œê³µ: <a href="https://map.kakao.com/" target="_blank" rel="noopener">KakaoMap</a></div>
        </div>
      </footer>
    </div>

    <script>
      // ===== Kakao SDK ë¡œë“œ & ì§€ë„ ì´ˆê¸°í™” =====
      (function boot(){
        if (window.kakao && kakao.maps && typeof kakao.maps.load === 'function') {
          kakao.maps.load(initMap);
        } else {
          setTimeout(boot, 50);
        }
      })();

      let map, places, markers=[], lastBounds=null;

      // í—¤ë”/í‘¸í„° ë†’ì´ì— ë§ì¶° ì§€ë„ ì„¸ë¡œê³µê°„ ê³„ì‚°
      function resizeMapHeight() {
        const headerH = document.querySelector('header.top')?.offsetHeight || 0;
        const footerH = document.querySelector('footer')?.offsetHeight || 0;
        const vh = window.innerHeight || document.documentElement.clientHeight;
        const mapWrap = document.getElementById('mapWrap');
        mapWrap.style.height = Math.max(240, vh - headerH - footerH) + 'px';
      }
      window.addEventListener('resize', ()=>{
        resizeMapHeight();
        if (map) kakao.maps.event.trigger(map, 'resize');
      });

      function initMap(){
        resizeMapHeight();

        const center = new kakao.maps.LatLng(37.5662952, 126.9779451); // ì„œìš¸ ì¤‘ì‹¬
        map = new kakao.maps.Map(document.getElementById('map'), { center, level:5 });
        places = new kakao.maps.services.Places();

        // ìƒë‹¨ ê²€ìƒ‰(ê°„ë‹¨)
        document.getElementById('searchBtn').addEventListener('click', onSearch);
        document.getElementById('keyword').addEventListener('keydown', (e)=>{ if(e.key==='Enter') onSearch(); });

        // ì§€ë„ íƒ€ì…
        document.getElementById('roadmap').addEventListener('click', ()=> map.setMapTypeId(kakao.maps.MapTypeId.ROADMAP));
        document.getElementById('skyview').addEventListener('click', ()=> map.setMapTypeId(kakao.maps.MapTypeId.HYBRID));
        document.getElementById('fitBoundsBtn').addEventListener('click', ()=>{ if(lastBounds) map.setBounds(lastBounds); });
      }

      function onSearch(){
        const q = document.getElementById('keyword').value.trim();
        if(!q) return;
        places.keywordSearch(q, (data, status) => {
          if(status !== kakao.maps.services.Status.OK){ clearMarkers(); lastBounds=null; return; }
          clearMarkers();
          const bounds = new kakao.maps.LatLngBounds();
          data.forEach(p=>{
            const pos = new kakao.maps.LatLng(p.y, p.x);
            bounds.extend(pos);
            const m = new kakao.maps.Marker({ position: pos });
            markers.push(m); m.setMap(map);
          });
          lastBounds=bounds; map.setBounds(bounds);
        }, { size: 12 });
      }

      function clearMarkers(){ markers.forEach(m=>m.setMap(null)); markers=[]; }
    </script>
  </body>
</html>
